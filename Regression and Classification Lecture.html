<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Regression and Classification Lecture - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/source_code_pro.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"useReactTableCreateView":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":false,"enableClearStateFeature":true,"enableJobsAclsV2InUI":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"3.3.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"riley.dallas@ga.co","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":false,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-280a8d41cd338f5b48d43eb87622c542c6e6584c430f6d3afe8f3401b9607cb9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-dd410c68e21c3c563ad6128d35705b605d70530124d55aff1dd12d7e15adfa20","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (3.4, GPU, Scala 2.11)","packageLabel":"spark-image-40f6dfb2a2502164930a89baac5ceba51d0af3142c7a13d8e9ead8c0cf100efe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-ecd6c5107c6be684ff96a08dfcc195a1eb89d5a3a3048cdb40fbf52fc1d75ddc","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (3.5 snapshot, Scala 2.10)","packageLabel":"spark-image-6d6db23df89c2ebf74cd4b123eb61c89b7a62dd2811e4b60ac211f713d2d29fc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (3.5, Scala 2.11)","packageLabel":"spark-image-210fca3448fbdcc2cdf1440d9d64de7834ff21c47d21459f338899fce8d4f8a5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (3.4, Scala 2.11)","packageLabel":"spark-image-ecd6c5107c6be684ff96a08dfcc195a1eb89d5a3a3048cdb40fbf52fc1d75ddc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-f39eba6a54a8a757dda9ed410e01316d4882a3ca6874bd90d119bbccea85e355","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (3.5, Scala 2.10)","packageLabel":"spark-image-6d6db23df89c2ebf74cd4b123eb61c89b7a62dd2811e4b60ac211f713d2d29fc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (3.4, Scala 2.10)","packageLabel":"spark-image-8e4c9eb80690e8553eadff617739e4125264e7fc9ce3bad494f7d19627557a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-40f6dfb2a2502164930a89baac5ceba51d0af3142c7a13d8e9ead8c0cf100efe","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (3.5 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-e2fbd754ad2a29fed178bb6c853146e35b4370b19d96b95accacb57d2745e02b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-73a161da0570b3f51c8eb238602af2f5561789ea80b25c69a48691fc84e2d974","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-8861ac5401d385cdb400eaa01fef0e32b1b29f24f4fd079d34f8f9994e44ff99","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (3.5 snapshot, Scala 2.11)","packageLabel":"spark-image-210fca3448fbdcc2cdf1440d9d64de7834ff21c47d21459f338899fce8d4f8a5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (3.5 GPU, Scala 2.11)","packageLabel":"spark-image-e2fbd754ad2a29fed178bb6c853146e35b4370b19d96b95accacb57d2745e02b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-8e4c9eb80690e8553eadff617739e4125264e7fc9ce3bad494f7d19627557a6c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS14":4,"r4.16xlarge":16,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":8,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"c3.8xlarge":4,"Standard_E2s_v3":0.5,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_D2_v2":0.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.59.833","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-73a161da0570b3f51c8eb238602af2f5561789ea80b25c69a48691fc84e2d974","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"riley.dallas@ga.co","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableStructuredDataAcls":false,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":false,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3312085998032250,"name":"Regression and Classification Lecture","language":"scala","commands":[{"version":"CommandV1","origId":3312085998032260,"guid":"b714dfe0-fe05-4c77-ae7d-8f2adaf4d865","subtype":"command","commandType":"auto","position":0.5,"command":"import org.apache.spark.ml.feature.{VectorAssembler, StringIndexer}\nimport org.apache.spark.ml.regression.RandomForestRegressor\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.{RegressionEvaluator, MulticlassClassificationEvaluator}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.feature.{VectorAssembler, StringIndexer}\nimport org.apache.spark.ml.regression.RandomForestRegressor\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.{RegressionEvaluator, MulticlassClassificationEvaluator}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512491646864,"submitTime":1512491646836,"finishTime":1512491646969,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5d86e367-a57c-4188-a7e6-f16d63f4d3b0"},{"version":"CommandV1","origId":3312085998032251,"guid":"2621570e-9101-4eb6-a337-d9930bc74bd9","subtype":"command","commandType":"auto","position":1.0,"command":"var df = sqlContext\n  .read\n  .format(\"csv\")\n  .option(\"header\", \"true\")\n  .option(\"inferSchema\", \"true\")\n  .load(\"/FileStore/tables/Advertising.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [_c0: int, TV: double ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"TV","type":"double","nullable":true,"metadata":{}},{"name":"radio","type":"double","nullable":true,"metadata":{}},{"name":"newspaper","type":"double","nullable":true,"metadata":{}},{"name":"sales","type":"double","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512486721245,"submitTime":1512486687329,"finishTime":1512486733477,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"81d9af93-50e7-4b78-925a-ea6ac5d2ea11"},{"version":"CommandV1","origId":3312085998032255,"guid":"9dbc1f38-701c-4599-8f27-a9ee651f46d1","subtype":"command","commandType":"auto","position":2.0,"command":"df.dtypes","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res1: Array[(String, String)] = Array((_c0,IntegerType), (TV,DoubleType), (radio,DoubleType), (newspaper,DoubleType), (sales,DoubleType))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487086239,"submitTime":1512487086212,"finishTime":1512487086660,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"61f24a8b-c8fd-4f14-94ad-66c91eefdec8"},{"version":"CommandV1","origId":3312085998032256,"guid":"ad43fc92-7f38-4532-ae05-401a6f600e93","subtype":"command","commandType":"auto","position":3.0,"command":"df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+-----+---------+-----+\n|_c0|   TV|radio|newspaper|sales|\n+---+-----+-----+---------+-----+\n|  1|230.1| 37.8|     69.2| 22.1|\n|  2| 44.5| 39.3|     45.1| 10.4|\n|  3| 17.2| 45.9|     69.3|  9.3|\n|  4|151.5| 41.3|     58.5| 18.5|\n|  5|180.8| 10.8|     58.4| 12.9|\n|  6|  8.7| 48.9|     75.0|  7.2|\n|  7| 57.5| 32.8|     23.5| 11.8|\n|  8|120.2| 19.6|     11.6| 13.2|\n|  9|  8.6|  2.1|      1.0|  4.8|\n| 10|199.8|  2.6|     21.2| 10.6|\n| 11| 66.1|  5.8|     24.2|  8.6|\n| 12|214.7| 24.0|      4.0| 17.4|\n| 13| 23.8| 35.1|     65.9|  9.2|\n| 14| 97.5|  7.6|      7.2|  9.7|\n| 15|204.1| 32.9|     46.0| 19.0|\n| 16|195.4| 47.7|     52.9| 22.4|\n| 17| 67.8| 36.6|    114.0| 12.5|\n| 18|281.4| 39.6|     55.8| 24.4|\n| 19| 69.2| 20.5|     18.3| 11.3|\n| 20|147.3| 23.9|     19.1| 14.6|\n+---+-----+-----+---------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487147688,"submitTime":1512487147662,"finishTime":1512487148493,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f18fb95b-05b5-4e17-9c44-9438e5d99134"},{"version":"CommandV1","origId":3312085998032257,"guid":"d70af25f-94df-42aa-bf44-dc580704def6","subtype":"command","commandType":"auto","position":4.0,"command":"df = df.withColumnRenamed(\"sales\", \"label\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [_c0: int, TV: double ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487279412,"submitTime":1512487279388,"finishTime":1512487279594,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e657c21-203b-4392-bf96-5b7f77216449"},{"version":"CommandV1","origId":3312085998032258,"guid":"e3ffef89-8191-4e63-9afd-e6a2e86cc803","subtype":"command","commandType":"auto","position":5.0,"command":"df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+-----+---------+-----+\n|_c0|   TV|radio|newspaper|label|\n+---+-----+-----+---------+-----+\n|  1|230.1| 37.8|     69.2| 22.1|\n|  2| 44.5| 39.3|     45.1| 10.4|\n|  3| 17.2| 45.9|     69.3|  9.3|\n|  4|151.5| 41.3|     58.5| 18.5|\n|  5|180.8| 10.8|     58.4| 12.9|\n|  6|  8.7| 48.9|     75.0|  7.2|\n|  7| 57.5| 32.8|     23.5| 11.8|\n|  8|120.2| 19.6|     11.6| 13.2|\n|  9|  8.6|  2.1|      1.0|  4.8|\n| 10|199.8|  2.6|     21.2| 10.6|\n| 11| 66.1|  5.8|     24.2|  8.6|\n| 12|214.7| 24.0|      4.0| 17.4|\n| 13| 23.8| 35.1|     65.9|  9.2|\n| 14| 97.5|  7.6|      7.2|  9.7|\n| 15|204.1| 32.9|     46.0| 19.0|\n| 16|195.4| 47.7|     52.9| 22.4|\n| 17| 67.8| 36.6|    114.0| 12.5|\n| 18|281.4| 39.6|     55.8| 24.4|\n| 19| 69.2| 20.5|     18.3| 11.3|\n| 20|147.3| 23.9|     19.1| 14.6|\n+---+-----+-----+---------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487293808,"submitTime":1512487293783,"finishTime":1512487294250,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aef4295f-0ece-411a-8be3-7deb7f4d94bc"},{"version":"CommandV1","origId":3312085998032259,"guid":"2f470569-7820-4e2c-98be-9c4a48db2b11","subtype":"command","commandType":"auto","position":6.0,"command":"val assembler = new VectorAssembler()\n  .setInputCols(Array(\"TV\", \"newspaper\", \"radio\"))\n  .setOutputCol(\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">assembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_64b07ebca657\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487613844,"submitTime":1512487613814,"finishTime":1512487614355,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"16acd173-2c31-41dd-bdde-ebf2c0030b1a"},{"version":"CommandV1","origId":3312085998032261,"guid":"5b98c8e3-2f29-44e1-a380-ee25734e08a2","subtype":"command","commandType":"auto","position":7.0,"command":"df = assembler.transform(df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [_c0: int, TV: double ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487725376,"submitTime":1512487725351,"finishTime":1512487725562,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9afe5333-5590-4605-9b74-61770a25b498"},{"version":"CommandV1","origId":3312085998032262,"guid":"6ed2c9d6-676b-4e00-bae2-55ee089ab7ed","subtype":"command","commandType":"auto","position":8.0,"command":"df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+-----+---------+-----+-----------------+\n|_c0|   TV|radio|newspaper|label|         features|\n+---+-----+-----+---------+-----+-----------------+\n|  1|230.1| 37.8|     69.2| 22.1|[230.1,69.2,37.8]|\n|  2| 44.5| 39.3|     45.1| 10.4| [44.5,45.1,39.3]|\n|  3| 17.2| 45.9|     69.3|  9.3| [17.2,69.3,45.9]|\n|  4|151.5| 41.3|     58.5| 18.5|[151.5,58.5,41.3]|\n|  5|180.8| 10.8|     58.4| 12.9|[180.8,58.4,10.8]|\n|  6|  8.7| 48.9|     75.0|  7.2|  [8.7,75.0,48.9]|\n|  7| 57.5| 32.8|     23.5| 11.8| [57.5,23.5,32.8]|\n|  8|120.2| 19.6|     11.6| 13.2|[120.2,11.6,19.6]|\n|  9|  8.6|  2.1|      1.0|  4.8|    [8.6,1.0,2.1]|\n| 10|199.8|  2.6|     21.2| 10.6| [199.8,21.2,2.6]|\n| 11| 66.1|  5.8|     24.2|  8.6|  [66.1,24.2,5.8]|\n| 12|214.7| 24.0|      4.0| 17.4| [214.7,4.0,24.0]|\n| 13| 23.8| 35.1|     65.9|  9.2| [23.8,65.9,35.1]|\n| 14| 97.5|  7.6|      7.2|  9.7|   [97.5,7.2,7.6]|\n| 15|204.1| 32.9|     46.0| 19.0|[204.1,46.0,32.9]|\n| 16|195.4| 47.7|     52.9| 22.4|[195.4,52.9,47.7]|\n| 17| 67.8| 36.6|    114.0| 12.5|[67.8,114.0,36.6]|\n| 18|281.4| 39.6|     55.8| 24.4|[281.4,55.8,39.6]|\n| 19| 69.2| 20.5|     18.3| 11.3| [69.2,18.3,20.5]|\n| 20|147.3| 23.9|     19.1| 14.6|[147.3,19.1,23.9]|\n+---+-----+-----+---------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487731968,"submitTime":1512487731942,"finishTime":1512487732538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"132f5a18-db0a-4867-b8d0-7f99b3a41a0a"},{"version":"CommandV1","origId":3312085998032263,"guid":"9894342d-1364-45ff-8cef-5995a7be7a2a","subtype":"command","commandType":"auto","position":9.0,"command":"var Array(train, test) = df.randomSplit(Array(.8, .2), 2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [_c0: int, TV: double ... 4 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [_c0: int, TV: double ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"TV","type":"double","nullable":true,"metadata":{}},{"name":"radio","type":"double","nullable":true,"metadata":{}},{"name":"newspaper","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":true,"metadata":{}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"TV"},{"idx":1,"name":"newspaper"},{"idx":2,"name":"radio"}]},"num_attrs":3}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"TV","type":"double","nullable":true,"metadata":{}},{"name":"radio","type":"double","nullable":true,"metadata":{}},{"name":"newspaper","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":true,"metadata":{}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"TV"},{"idx":1,"name":"newspaper"},{"idx":2,"name":"radio"}]},"num_attrs":3}}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487909142,"submitTime":1512487909116,"finishTime":1512487910142,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"973e8abc-b8c0-4cb7-b70c-2db19402658b"},{"version":"CommandV1","origId":3312085998032264,"guid":"0072c335-96be-40a9-b369-89351b10c11e","subtype":"command","commandType":"auto","position":10.0,"command":"train.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+-----+---------+-----+-----------------+\n|_c0|   TV|radio|newspaper|label|         features|\n+---+-----+-----+---------+-----+-----------------+\n|  1|230.1| 37.8|     69.2| 22.1|[230.1,69.2,37.8]|\n|  2| 44.5| 39.3|     45.1| 10.4| [44.5,45.1,39.3]|\n|  3| 17.2| 45.9|     69.3|  9.3| [17.2,69.3,45.9]|\n|  4|151.5| 41.3|     58.5| 18.5|[151.5,58.5,41.3]|\n|  5|180.8| 10.8|     58.4| 12.9|[180.8,58.4,10.8]|\n|  6|  8.7| 48.9|     75.0|  7.2|  [8.7,75.0,48.9]|\n|  8|120.2| 19.6|     11.6| 13.2|[120.2,11.6,19.6]|\n|  9|  8.6|  2.1|      1.0|  4.8|    [8.6,1.0,2.1]|\n| 10|199.8|  2.6|     21.2| 10.6| [199.8,21.2,2.6]|\n| 11| 66.1|  5.8|     24.2|  8.6|  [66.1,24.2,5.8]|\n| 13| 23.8| 35.1|     65.9|  9.2| [23.8,65.9,35.1]|\n| 14| 97.5|  7.6|      7.2|  9.7|   [97.5,7.2,7.6]|\n| 15|204.1| 32.9|     46.0| 19.0|[204.1,46.0,32.9]|\n| 16|195.4| 47.7|     52.9| 22.4|[195.4,52.9,47.7]|\n| 17| 67.8| 36.6|    114.0| 12.5|[67.8,114.0,36.6]|\n| 18|281.4| 39.6|     55.8| 24.4|[281.4,55.8,39.6]|\n| 19| 69.2| 20.5|     18.3| 11.3| [69.2,18.3,20.5]|\n| 20|147.3| 23.9|     19.1| 14.6|[147.3,19.1,23.9]|\n| 22|237.4|  5.1|     23.5| 12.5| [237.4,23.5,5.1]|\n| 23| 13.2| 15.9|     49.6|  5.6| [13.2,49.6,15.9]|\n+---+-----+-----+---------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512487925104,"submitTime":1512487925070,"finishTime":1512487925854,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f83957a6-0264-410e-b397-91fe457fc901"},{"version":"CommandV1","origId":3312085998032265,"guid":"3a54453e-0c18-4ac5-9064-cf116ce36d10","subtype":"command","commandType":"auto","position":11.0,"command":"var rf = new RandomForestRegressor()\n  .setNumTrees(30)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rf: org.apache.spark.ml.regression.RandomForestRegressor = rfr_bd488a9a0485\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512488268423,"submitTime":1512488268387,"finishTime":1512488268620,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e0c4a7b0-563e-4845-a8a5-b61e1631c88c"},{"version":"CommandV1","origId":3312085998032266,"guid":"7785b165-ec2a-407a-b53a-8ad384163b53","subtype":"command","commandType":"auto","position":12.0,"command":"var rfModel = rf.fit(train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rfModel: org.apache.spark.ml.regression.RandomForestRegressionModel = RandomForestRegressionModel (uid=rfr_bd488a9a0485) with 30 trees\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512488364806,"submitTime":1512488364781,"finishTime":1512488366138,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"101121eb-540e-45ae-a4e1-2c636fb2cea8"},{"version":"CommandV1","origId":3312085998032267,"guid":"e7a9a584-8b45-4378-884a-ad0cc1826a4a","subtype":"command","commandType":"auto","position":13.0,"command":"var predictions = rfModel.transform(test)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">predictions: org.apache.spark.sql.DataFrame = [_c0: int, TV: double ... 5 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"TV","type":"double","nullable":true,"metadata":{}},{"name":"radio","type":"double","nullable":true,"metadata":{}},{"name":"newspaper","type":"double","nullable":true,"metadata":{}},{"name":"label","type":"double","nullable":true,"metadata":{}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"TV"},{"idx":1,"name":"newspaper"},{"idx":2,"name":"radio"}]},"num_attrs":3}}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512488446304,"submitTime":1512488446279,"finishTime":1512488446896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f23377e5-e746-409c-8766-fbe946a92716"},{"version":"CommandV1","origId":3312085998032268,"guid":"e0fe4ab5-30b3-447f-859e-2c2e2c56986b","subtype":"command","commandType":"auto","position":14.0,"command":"predictions.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----+-----+---------+-----+-----------------+------------------+\n|_c0|   TV|radio|newspaper|label|         features|        prediction|\n+---+-----+-----+---------+-----+-----------------+------------------+\n|  7| 57.5| 32.8|     23.5| 11.8| [57.5,23.5,32.8]|10.473575123584455|\n| 12|214.7| 24.0|      4.0| 17.4| [214.7,4.0,24.0]| 16.37371486674069|\n| 21|218.4| 27.7|     53.4| 18.0|[218.4,53.4,27.7]|19.020891055839584|\n| 28|240.1| 16.7|     22.9| 15.9|[240.1,22.9,16.7]|14.769389758063285|\n| 31|292.9| 28.3|     43.2| 21.4|[292.9,43.2,28.3]|19.540090017696443|\n| 36|290.7|  4.1|      8.5| 12.8|  [290.7,8.5,4.1]|13.383276216376213|\n| 44|206.9|  8.4|     26.4| 12.9| [206.9,26.4,8.4]|12.646813061592939|\n| 45| 25.1| 25.7|     43.3|  8.5| [25.1,43.3,25.7]| 10.18763899730444|\n| 52|100.4|  9.6|      3.6| 10.7|  [100.4,3.6,9.6]|10.478129379424178|\n| 57|  7.3| 28.1|     41.4|  5.5|  [7.3,41.4,28.1]| 8.797999251021311|\n| 62|261.3| 42.7|     54.7| 24.2|[261.3,54.7,42.7]|21.636044782069785|\n| 64|102.7| 29.6|      8.4| 14.0| [102.7,8.4,29.6]|11.842811569417197|\n| 70|216.8| 43.9|     27.2| 22.3|[216.8,27.2,43.9]|19.922537018310596|\n| 78|120.5| 28.5|     14.2| 14.2|[120.5,14.2,28.5]|14.869002087912861|\n| 82|239.8|  4.1|     36.9| 12.3| [239.8,36.9,4.1]|13.758885912235916|\n| 90|109.8| 47.8|     51.4| 16.7|[109.8,51.4,47.8]|16.301220684870685|\n| 97|197.6|  3.5|      5.9| 11.7|  [197.6,5.9,3.5]|13.764269073971361|\n|100|135.2| 41.7|     45.9| 17.2|[135.2,45.9,41.7]|18.155428342137164|\n|114|209.6| 20.6|     10.7| 15.9|[209.6,10.7,20.6]|15.469728828412547|\n|121|141.3| 26.8|     46.2| 15.5|[141.3,46.2,26.8]| 15.66897037616056|\n+---+-----+-----+---------+-----+-----------------+------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512488468749,"submitTime":1512488468723,"finishTime":1512488469242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7ab8d45b-b1fd-4e03-bca3-69ed1ab6ec1b"},{"version":"CommandV1","origId":3312085998032269,"guid":"683961e5-1da9-40ee-9f2a-8637e312d6ca","subtype":"command","commandType":"auto","position":15.0,"command":"val evaluator = new RegressionEvaluator()\n  .setMetricName(\"r2\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">evaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_dc844e7bb561\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512488831112,"submitTime":1512488831089,"finishTime":1512488831268,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2761a4bf-e09a-42ac-9b67-e01c964cf3e0"},{"version":"CommandV1","origId":3312085998032270,"guid":"708a3bd6-5d09-452f-9850-d1c264e9d1d0","subtype":"command","commandType":"auto","position":16.0,"command":"evaluator.evaluate(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res19: Double = 0.851374739828969\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"java.lang.IllegalArgumentException: Field \"prediction\" does not exist.","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:267)\n\tat org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:267)\n\tat scala.collection.MapLike$class.getOrElse(MapLike.scala:128)\n\tat scala.collection.AbstractMap.getOrElse(Map.scala:59)\n\tat org.apache.spark.sql.types.StructType.apply(StructType.scala:266)\n\tat org.apache.spark.ml.util.SchemaUtils$.checkColumnTypes(SchemaUtils.scala:56)\n\tat org.apache.spark.ml.evaluation.RegressionEvaluator.evaluate(RegressionEvaluator.scala:77)\n\tat line916372774fb9413ab9838463247fbe4298.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032270:1)\n\tat line916372774fb9413ab9838463247fbe4298.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032270:54)\n\tat line916372774fb9413ab9838463247fbe4298.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032270:56)\n\tat line916372774fb9413ab9838463247fbe4298.$read$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032270:58)\n\tat line916372774fb9413ab9838463247fbe4298.$read$$iw$$iw.&lt;init&gt;(command-3312085998032270:60)\n\tat line916372774fb9413ab9838463247fbe4298.$read$$iw.&lt;init&gt;(command-3312085998032270:62)\n\tat line916372774fb9413ab9838463247fbe4298.$read.&lt;init&gt;(command-3312085998032270:64)\n\tat line916372774fb9413ab9838463247fbe4298.$read$.&lt;init&gt;(command-3312085998032270:68)\n\tat line916372774fb9413ab9838463247fbe4298.$read$.&lt;clinit&gt;(command-3312085998032270)\n\tat line916372774fb9413ab9838463247fbe4298.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat line916372774fb9413ab9838463247fbe4298.$eval$.$print(&lt;notebook&gt;:6)\n\tat line916372774fb9413ab9838463247fbe4298.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:410)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:234)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:215)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:215)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1512488951695,"submitTime":1512488951670,"finishTime":1512488952319,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e12358c-1c50-4daf-a9a1-1e6610465d89"},{"version":"CommandV1","origId":3312085998032271,"guid":"b204ea79-f5fe-4a60-9878-fffda0d50de5","subtype":"command","commandType":"auto","position":17.0,"command":"// CLASSIFICATION","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490080391,"submitTime":1512490080365,"finishTime":1512490080513,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b00efd5-9f86-4377-8e14-735c087da5b7"},{"version":"CommandV1","origId":3312085998032272,"guid":"3789eb19-c870-43b0-933f-fac9016018d2","subtype":"command","commandType":"auto","position":18.0,"command":"var df = sqlContext\n  .read\n  .format(\"csv\")\n  .option(\"inferSchema\", \"true\")\n  .option(\"header\", \"true\")\n  .load(\"/FileStore/tables/iris.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [_c0: int, sepal length (cm): double ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"sepal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"sepal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"species","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490678184,"submitTime":1512490678161,"finishTime":1512490679070,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"289f3af9-cab7-44d7-adc7-f16fc9932166"},{"version":"CommandV1","origId":3312085998032273,"guid":"c7dabf09-a7f7-4554-b120-5d1acebea95e","subtype":"command","commandType":"auto","position":19.0,"command":"df.dtypes","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res22: Array[(String, String)] = Array((_c0,IntegerType), (sepal length (cm),DoubleType), (sepal width (cm),DoubleType), (petal length (cm),DoubleType), (petal width (cm),DoubleType), (species,StringType))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490145463,"submitTime":1512490145435,"finishTime":1512490145658,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b416384b-837d-49ba-942b-d51344de55bd"},{"version":"CommandV1","origId":3312085998032274,"guid":"7d45113d-bf3a-466b-9222-0011cc7b6e59","subtype":"command","commandType":"auto","position":20.0,"command":"df.show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----------------+----------------+-----------------+----------------+-------+\n|_c0|sepal length (cm)|sepal width (cm)|petal length (cm)|petal width (cm)|species|\n+---+-----------------+----------------+-----------------+----------------+-------+\n|  0|              5.1|             3.5|              1.4|             0.2| setosa|\n|  1|              4.9|             3.0|              1.4|             0.2| setosa|\n|  2|              4.7|             3.2|              1.3|             0.2| setosa|\n|  3|              4.6|             3.1|              1.5|             0.2| setosa|\n|  4|              5.0|             3.6|              1.4|             0.2| setosa|\n+---+-----------------+----------------+-----------------+----------------+-------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490170481,"submitTime":1512490170455,"finishTime":1512490170892,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82d70e7f-e37e-4faf-83a2-288f406d8006"},{"version":"CommandV1","origId":3312085998032275,"guid":"88510d88-126f-42ed-a708-4e5abf4c829c","subtype":"command","commandType":"auto","position":21.0,"command":"var featureColumns = df.dtypes.filter(column => column._2 == \"DoubleType\").map(column => column._1)\n\nvar assembler = new VectorAssembler()\n  .setInputCols(featureColumns)\n  .setOutputCol(\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">assembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_a5e230779a09\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490688419,"submitTime":1512490688392,"finishTime":1512490688557,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78a3f7e5-b48f-495e-bd7d-71fc467aac91"},{"version":"CommandV1","origId":3312085998032276,"guid":"6fb78ab1-3857-45dd-8dab-37c20d476f90","subtype":"command","commandType":"auto","position":22.0,"command":"df = assembler.transform(df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [_c0: int, sepal length (cm): double ... 5 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"java.lang.IllegalArgumentException: Output column features already exists.","error":"<div class=\"ansiout\">\tat org.apache.spark.ml.feature.VectorAssembler.transformSchema(VectorAssembler.scala:124)\n\tat org.apache.spark.ml.PipelineStage.transformSchema(Pipeline.scala:74)\n\tat org.apache.spark.ml.feature.VectorAssembler.transform(VectorAssembler.scala:54)\n\tat line916372774fb9413ab9838463247fbe42122.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032276:1)\n\tat line916372774fb9413ab9838463247fbe42122.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032276:52)\n\tat line916372774fb9413ab9838463247fbe42122.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032276:54)\n\tat line916372774fb9413ab9838463247fbe42122.$read$$iw$$iw$$iw.&lt;init&gt;(command-3312085998032276:56)\n\tat line916372774fb9413ab9838463247fbe42122.$read$$iw$$iw.&lt;init&gt;(command-3312085998032276:58)\n\tat line916372774fb9413ab9838463247fbe42122.$read$$iw.&lt;init&gt;(command-3312085998032276:60)\n\tat line916372774fb9413ab9838463247fbe42122.$read.&lt;init&gt;(command-3312085998032276:62)\n\tat line916372774fb9413ab9838463247fbe42122.$read$.&lt;init&gt;(command-3312085998032276:66)\n\tat line916372774fb9413ab9838463247fbe42122.$read$.&lt;clinit&gt;(command-3312085998032276)\n\tat line916372774fb9413ab9838463247fbe42122.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat line916372774fb9413ab9838463247fbe42122.$eval$.$print(&lt;notebook&gt;:6)\n\tat line916372774fb9413ab9838463247fbe42122.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:786)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1047)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:638)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest$$anonfun$loadAndRunReq$1.apply(IMain.scala:637)\n\tat scala.reflect.internal.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:31)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:19)\n\tat scala.tools.nsc.interpreter.IMain$WrappedRequest.loadAndRunReq(IMain.scala:637)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:569)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:565)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:186)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply$mcV$sp(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal$$anonfun$repl$1.apply(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:456)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:410)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:234)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:215)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:215)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:601)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:596)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:554)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1512490691617,"submitTime":1512490691589,"finishTime":1512490691763,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"58834332-385b-4a73-a264-4ec13e139abf"},{"version":"CommandV1","origId":3312085998032277,"guid":"111aae2c-73c0-4e82-89be-02dfc6d4e64b","subtype":"command","commandType":"auto","position":23.0,"command":"df.show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----------------+----------------+-----------------+----------------+-------+-----------------+\n|_c0|sepal length (cm)|sepal width (cm)|petal length (cm)|petal width (cm)|species|         features|\n+---+-----------------+----------------+-----------------+----------------+-------+-----------------+\n|  0|              5.1|             3.5|              1.4|             0.2| setosa|[5.1,3.5,1.4,0.2]|\n|  1|              4.9|             3.0|              1.4|             0.2| setosa|[4.9,3.0,1.4,0.2]|\n|  2|              4.7|             3.2|              1.3|             0.2| setosa|[4.7,3.2,1.3,0.2]|\n|  3|              4.6|             3.1|              1.5|             0.2| setosa|[4.6,3.1,1.5,0.2]|\n|  4|              5.0|             3.6|              1.4|             0.2| setosa|[5.0,3.6,1.4,0.2]|\n+---+-----------------+----------------+-----------------+----------------+-------+-----------------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490695155,"submitTime":1512490695127,"finishTime":1512490695611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"168da678-205c-49b8-aa91-61ec4f121137"},{"version":"CommandV1","origId":3312085998032278,"guid":"9ff2e061-9d05-440d-b558-68af825b3e3a","subtype":"command","commandType":"auto","position":24.0,"command":"val labelIndexer = new StringIndexer()\n  .setInputCol(\"species\")\n  .setOutputCol(\"label\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">labelIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_9822a7e44fb6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490912062,"submitTime":1512490912034,"finishTime":1512490912242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6072029-805d-480a-bd9f-a94975ce2f27"},{"version":"CommandV1","origId":3312085998032280,"guid":"dd985a76-1be4-4337-afee-1a0f45b2b430","subtype":"command","commandType":"auto","position":25.0,"command":"val labelIndexerModel = labelIndexer.fit(df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">labelIndexerModel: org.apache.spark.ml.feature.StringIndexerModel = strIdx_9822a7e44fb6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490954982,"submitTime":1512490954955,"finishTime":1512490955421,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f67e3c42-fef6-40f8-a576-dfc94af8f57f"},{"version":"CommandV1","origId":3312085998032281,"guid":"cf13f189-30cb-4b02-9b8a-106faaf11268","subtype":"command","commandType":"auto","position":26.0,"command":"df = labelIndexerModel.transform(df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [_c0: int, sepal length (cm): double ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512490976576,"submitTime":1512490976549,"finishTime":1512490976738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bf7ffed5-bd1f-4448-a655-6ae3beee6928"},{"version":"CommandV1","origId":3312085998032282,"guid":"64ae69ed-70ee-4d3b-bc6c-440af27aa41c","subtype":"command","commandType":"auto","position":27.0,"command":"df.select(\"features\", \"label\").show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+-----+\n|         features|label|\n+-----------------+-----+\n|[5.1,3.5,1.4,0.2]|  2.0|\n|[4.9,3.0,1.4,0.2]|  2.0|\n|[4.7,3.2,1.3,0.2]|  2.0|\n|[4.6,3.1,1.5,0.2]|  2.0|\n|[5.0,3.6,1.4,0.2]|  2.0|\n+-----------------+-----+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512491055915,"submitTime":1512491055890,"finishTime":1512491056423,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"04520bae-6fdb-40fc-83ab-1d1e6005c94e"},{"version":"CommandV1","origId":3312085998032283,"guid":"c197b3b7-b64c-4d9c-86e9-906e1c18a1c9","subtype":"command","commandType":"auto","position":28.0,"command":"var Array(train, test) = df.randomSplit(Array(.8, .2), 2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [_c0: int, sepal length (cm): double ... 6 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [_c0: int, sepal length (cm): double ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"train","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"sepal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"sepal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"species","type":"string","nullable":true,"metadata":{}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"sepal length (cm)"},{"idx":1,"name":"sepal width (cm)"},{"idx":2,"name":"petal length (cm)"},{"idx":3,"name":"petal width (cm)"}]},"num_attrs":4}}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["versicolor","virginica","setosa"],"type":"nominal","name":"label"}}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"sepal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"sepal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"species","type":"string","nullable":true,"metadata":{}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"sepal length (cm)"},{"idx":1,"name":"sepal width (cm)"},{"idx":2,"name":"petal length (cm)"},{"idx":3,"name":"petal width (cm)"}]},"num_attrs":4}}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["versicolor","virginica","setosa"],"type":"nominal","name":"label"}}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512491199775,"submitTime":1512491199748,"finishTime":1512491200284,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"355e5794-8229-460b-b396-a68cc6a3c018"},{"version":"CommandV1","origId":3312085998032286,"guid":"7cb1a078-ec20-43ef-a62a-a498869fe2a2","subtype":"command","commandType":"auto","position":31.0,"command":"var rf = new RandomForestClassifier()\n  .setNumTrees(30)\n\nvar rfModel = rf.fit(train)\n\nvar predictions = rfModel.transform(test)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">predictions: org.apache.spark.sql.DataFrame = [_c0: int, sepal length (cm): double ... 9 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"_c0","type":"integer","nullable":true,"metadata":{}},{"name":"sepal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"sepal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal length (cm)","type":"double","nullable":true,"metadata":{}},{"name":"petal width (cm)","type":"double","nullable":true,"metadata":{}},{"name":"species","type":"string","nullable":true,"metadata":{}},{"name":"features","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"sepal length (cm)"},{"idx":1,"name":"sepal width (cm)"},{"idx":2,"name":"petal length (cm)"},{"idx":3,"name":"petal width (cm)"}]},"num_attrs":4}}},{"name":"label","type":"double","nullable":false,"metadata":{"ml_attr":{"vals":["versicolor","virginica","setosa"],"type":"nominal","name":"label"}}},{"name":"rawPrediction","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"probability","type":{"type":"udt","class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"type":"struct","fields":[{"name":"type","type":"byte","nullable":false,"metadata":{}},{"name":"size","type":"integer","nullable":true,"metadata":{}},{"name":"indices","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":true,"metadata":{}},{"name":"values","type":{"type":"array","elementType":"double","containsNull":false},"nullable":true,"metadata":{}}]}},"nullable":true,"metadata":{}},{"name":"prediction","type":"double","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512491405748,"submitTime":1512491405721,"finishTime":1512491406244,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7151d8a4-af4c-421b-bfec-6bdb572431a0"},{"version":"CommandV1","origId":3312085998032287,"guid":"deb03c34-5672-48e5-9d70-abf77b723aa1","subtype":"command","commandType":"auto","position":32.0,"command":"predictions.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----------------+----------------+-----------------+----------------+----------+-----------------+-----+--------------------+--------------------+----------+\n|_c0|sepal length (cm)|sepal width (cm)|petal length (cm)|petal width (cm)|   species|         features|label|       rawPrediction|         probability|prediction|\n+---+-----------------+----------------+-----------------+----------------+----------+-----------------+-----+--------------------+--------------------+----------+\n|  6|              4.6|             3.4|              1.4|             0.3|    setosa|[4.6,3.4,1.4,0.3]|  2.0|      [0.0,0.0,30.0]|       [0.0,0.0,1.0]|       2.0|\n| 11|              4.8|             3.4|              1.6|             0.2|    setosa|[4.8,3.4,1.6,0.2]|  2.0|      [0.0,0.0,30.0]|       [0.0,0.0,1.0]|       2.0|\n| 20|              5.4|             3.4|              1.7|             0.2|    setosa|[5.4,3.4,1.7,0.2]|  2.0|      [0.0,0.0,30.0]|       [0.0,0.0,1.0]|       2.0|\n| 27|              5.2|             3.5|              1.5|             0.2|    setosa|[5.2,3.5,1.5,0.2]|  2.0|      [0.0,0.0,30.0]|       [0.0,0.0,1.0]|       2.0|\n| 30|              4.8|             3.1|              1.6|             0.2|    setosa|[4.8,3.1,1.6,0.2]|  2.0|      [0.0,0.0,30.0]|       [0.0,0.0,1.0]|       2.0|\n| 35|              5.0|             3.2|              1.2|             0.2|    setosa|[5.0,3.2,1.2,0.2]|  2.0|      [0.0,0.0,30.0]|       [0.0,0.0,1.0]|       2.0|\n| 43|              5.0|             3.5|              1.6|             0.6|    setosa|[5.0,3.5,1.6,0.6]|  2.0|     [18.0,0.0,12.0]|       [0.6,0.0,0.4]|       0.0|\n| 44|              5.1|             3.8|              1.9|             0.4|    setosa|[5.1,3.8,1.9,0.4]|  2.0|      [4.0,0.0,26.0]|[0.13333333333333...|       2.0|\n| 51|              6.4|             3.2|              4.5|             1.5|versicolor|[6.4,3.2,4.5,1.5]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n| 56|              6.3|             3.3|              4.7|             1.6|versicolor|[6.3,3.3,4.7,1.6]|  0.0|      [22.0,8.0,0.0]|[0.73333333333333...|       0.0|\n| 61|              5.9|             3.0|              4.2|             1.5|versicolor|[5.9,3.0,4.2,1.5]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n| 63|              6.1|             2.9|              4.7|             1.4|versicolor|[6.1,2.9,4.7,1.4]|  0.0|      [29.0,1.0,0.0]|[0.96666666666666...|       0.0|\n| 69|              5.6|             2.5|              3.9|             1.1|versicolor|[5.6,2.5,3.9,1.1]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n| 77|              6.7|             3.0|              5.0|             1.7|versicolor|[6.7,3.0,5.0,1.7]|  0.0|      [0.0,30.0,0.0]|       [0.0,1.0,0.0]|       1.0|\n| 81|              5.5|             2.4|              3.7|             1.0|versicolor|[5.5,2.4,3.7,1.0]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n| 89|              5.5|             2.5|              4.0|             1.3|versicolor|[5.5,2.5,4.0,1.3]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n| 96|              5.7|             2.9|              4.2|             1.3|versicolor|[5.7,2.9,4.2,1.3]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n| 99|              5.7|             2.8|              4.1|             1.3|versicolor|[5.7,2.8,4.1,1.3]|  0.0|      [30.0,0.0,0.0]|       [1.0,0.0,0.0]|       0.0|\n|113|              5.7|             2.5|              5.0|             2.0| virginica|[5.7,2.5,5.0,2.0]|  1.0|[3.33333333333333...|[0.11111111111111...|       1.0|\n|120|              6.9|             3.2|              5.7|             2.3| virginica|[6.9,3.2,5.7,2.3]|  1.0|      [0.0,30.0,0.0]|       [0.0,1.0,0.0]|       1.0|\n+---+-----------------+----------------+-----------------+----------------+----------+-----------------+-----+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512491412344,"submitTime":1512491412315,"finishTime":1512491412897,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"97659246-6c05-4cda-911d-2c04d0df7ad8"},{"version":"CommandV1","origId":3312085998032289,"guid":"3247f57d-46a3-44a4-a566-c141c88d28ac","subtype":"command","commandType":"auto","position":34.0,"command":"val evaluator = new MulticlassClassificationEvaluator()\n  .setMetricName(\"accuracy\")\n\nevaluator.evaluate(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res33: Double = 0.9230769230769231\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512491994175,"submitTime":1512491994148,"finishTime":1512491994680,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5c2843c1-f054-4975-b144-12f69eb3edce"}],"dashboards":[],"guid":"7400b718-1cfe-4c69-9995-2f60f9f8f09b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
